name: Simple Auto PR

on:
  push:
    branches-ignore:
      - main
      - master
      - develop

jobs:
  create-pr:
    runs-on: ubuntu-latest
    if: github.ref != 'refs/heads/main' && github.ref != 'refs/heads/master' && github.ref != 'refs/heads/develop'
    
    steps:
    - name: Checkout
      uses: actions/checkout@v4
      with:
        fetch-depth: 0

    - name: Create Pull Request
      uses: peter-evans/create-pull-request@v5
      id: cpr
      with:
        token: ${{ secrets.GITHUB_TOKEN }}
        title: "ğŸ¤– Auto PR: ${{ github.ref_name }}"
        body: |
          ## ğŸ¤– è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸPull Request
          
          **ãƒ–ãƒ©ãƒ³ãƒ**: `${{ github.ref_name }}`
          **ãƒ™ãƒ¼ã‚¹**: `main`
          
          ### ğŸ“ å¤‰æ›´å†…å®¹
          ã“ã®PRã¯è‡ªå‹•çš„ã«ä½œæˆã•ã‚Œã¾ã—ãŸã€‚å¤‰æ›´å†…å®¹ã‚’ç¢ºèªã—ã¦ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚
          
          ### ğŸ” ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ
          - [ ] ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼å®Œäº†
          - [ ] ãƒ†ã‚¹ãƒˆå®Ÿè¡Œç¢ºèª
          - [ ] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰
          
          ### ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—
          1. GitHub Copilot ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒè‡ªå‹•å®Ÿè¡Œã•ã‚Œã¾ã™
          2. CI/CD ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ãŒå®Ÿè¡Œã•ã‚Œã¾ã™
          3. ãƒ¬ãƒ“ãƒ¥ãƒ¼å®Œäº†å¾Œã€ãƒãƒ¼ã‚¸å¯èƒ½ã«ãªã‚Šã¾ã™
          
          ---
          ğŸ¤– ã“ã®PRã¯ GitHub Actions ã«ã‚ˆã‚Šè‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã—ãŸ
        base: main
        branch: ${{ github.ref_name }}
        labels: |
          auto-generated
          needs-review

    - name: PR Info
      if: steps.cpr.outputs.pull-request-number
      run: |
        echo "Pull Request Number - ${{ steps.cpr.outputs.pull-request-number }}"
        echo "Pull Request URL - ${{ steps.cpr.outputs.pull-request-url }}"
        echo "âœ… PR #${{ steps.cpr.outputs.pull-request-number }} ãŒä½œæˆã•ã‚Œã¾ã—ãŸï¼"

    - name: Add comment with analysis
      if: steps.cpr.outputs.pull-request-number
      uses: peter-evans/create-or-update-comment@v3
      with:
        token: ${{ secrets.GITHUB_TOKEN }}
        issue-number: ${{ steps.cpr.outputs.pull-request-number }}
        body: |
          ## ğŸ¤– GitHub Copilot è‡ªå‹•åˆ†æé–‹å§‹
          
          ã“ã®PRã«å¯¾ã—ã¦ä»¥ä¸‹ã®åˆ†æã‚’å®Ÿè¡Œä¸­ã§ã™ï¼š
          
          - âœ… ã‚³ãƒ¼ãƒ‰å“è³ªãƒã‚§ãƒƒã‚¯
          - âœ… ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³  
          - âœ… ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åˆ†æ
          - âœ… ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹æ¤œè¨¼
          
          åˆ†æçµæœã¯æ•°åˆ†ä»¥å†…ã«ã‚³ãƒ¡ãƒ³ãƒˆã§å ±å‘Šã•ã‚Œã¾ã™ã€‚
          
          ---
          ğŸ’¡ **ãƒ’ãƒ³ãƒˆ**: ã‚ˆã‚Šè©³ç´°ãªãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒå¿…è¦ãªå ´åˆã¯ `@github-actions` ã«ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ã—ã¦ãã ã•ã„ã€‚
