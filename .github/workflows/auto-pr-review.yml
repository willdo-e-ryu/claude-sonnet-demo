name: Auto PR with Copilot Review

on:
  push:
    branches-ignore:
      - main
      - master
      - develop
  # feature/fix/ãªã©ã®ãƒ–ãƒ©ãƒ³ãƒã«ãƒ—ãƒƒã‚·ãƒ¥ã•ã‚ŒãŸæ™‚ã«å®Ÿè¡Œ

permissions:
  contents: write
  pull-requests: write
  issues: write
  repository-projects: read
  actions: read
  checks: read
  statuses: read

jobs:
  auto-pr-and-review:
    runs-on: ubuntu-latest
    if: github.ref != 'refs/heads/main' && github.ref != 'refs/heads/master' && github.ref != 'refs/heads/develop'
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      with:
        fetch-depth: 0
    
    - name: Get branch info
      id: branch_info
      run: |
        BRANCH_NAME=${GITHUB_REF#refs/heads/}
        BASE_BRANCH="master"
        
        # developãƒ–ãƒ©ãƒ³ãƒãŒå­˜åœ¨ã™ã‚‹å ´åˆã¯ãã¡ã‚‰ã‚’å„ªå…ˆ
        if git show-ref --verify --quiet refs/remotes/origin/develop; then
          BASE_BRANCH="develop"
        # mainãƒ–ãƒ©ãƒ³ãƒãŒå­˜åœ¨ã™ã‚‹å ´åˆ
        elif git show-ref --verify --quiet refs/remotes/origin/main; then
          BASE_BRANCH="main"
        fi
        
        echo "branch_name=$BRANCH_NAME" >> $GITHUB_OUTPUT
        echo "base_branch=$BASE_BRANCH" >> $GITHUB_OUTPUT
        echo "pr_title=ğŸ”„ Auto PR: $BRANCH_NAME" >> $GITHUB_OUTPUT
    
    - name: Check if PR already exists
      id: check_pr
      env:
        GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      run: |
        BRANCH_NAME="${{ steps.branch_info.outputs.branch_name }}"
        BASE_BRANCH="${{ steps.branch_info.outputs.base_branch }}"
        
        # æ—¢å­˜ã®PRã‚’ãƒã‚§ãƒƒã‚¯
        PR_NUMBER=$(gh pr list --head "$BRANCH_NAME" --base "$BASE_BRANCH" --json number --jq '.[0].number // empty' || echo "")
        
        if [ -n "$PR_NUMBER" ]; then
          echo "exists=true" >> $GITHUB_OUTPUT
          echo "pr_number=$PR_NUMBER" >> $GITHUB_OUTPUT
          echo "æ—¢å­˜ã®PR #$PR_NUMBER ãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ"
        else
          echo "exists=false" >> $GITHUB_OUTPUT
          echo "æ–°ã—ã„PRã‚’ä½œæˆã—ã¾ã™"
        fi
    
    - name: Generate commit summary
      id: commit_summary
      run: |
        BASE_BRANCH="${{ steps.branch_info.outputs.base_branch }}"
        
        # ã‚³ãƒŸãƒƒãƒˆã®å·®åˆ†ã‚’å–å¾—
        COMMITS=$(git log --oneline origin/$BASE_BRANCH..HEAD | head -10)
        FILES_CHANGED=$(git diff --name-only origin/$BASE_BRANCH..HEAD | head -20)
        
        # PRæœ¬æ–‡ã‚’ç”Ÿæˆï¼ˆsedã®ä»£ã‚ã‚Šã«echoã¨catã‚’ä½¿ç”¨ï¼‰
        {
          echo "## ğŸ¤– è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸPull Request"
          echo ""
          echo "### ğŸ“ å¤‰æ›´å†…å®¹"
          echo "**å¤‰æ›´ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«:**"
          echo '```'
          echo "$FILES_CHANGED"
          echo '```'
          echo ""
          echo "**ã‚³ãƒŸãƒƒãƒˆå±¥æ­´:**"
          echo '```'
          echo "$COMMITS"
          echo '```'
          echo ""
          echo "### ğŸ” ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒã‚¤ãƒ³ãƒˆ"
          echo "- [ ] ã‚³ãƒ¼ãƒ‰å“è³ª"
          echo "- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£"
          echo "- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹"
          echo "- [ ] ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸"
          echo "- [ ] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ"
          echo ""
          echo "### ğŸš€ ãƒ†ã‚¹ãƒˆçŠ¶æ³"
          echo "ã“ã®PRã¯è‡ªå‹•çš„ã«ä»¥ä¸‹ã®ãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè¡Œã—ã¾ã™ï¼š"
          echo "- âœ… æ§‹æ–‡ãƒã‚§ãƒƒã‚¯"
          echo "- âœ… Docker ãƒ“ãƒ«ãƒ‰ãƒ†ã‚¹ãƒˆ"
          echo "- âœ… ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³"
          echo "- âœ… GitHub Copilot ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼"
          echo ""
          echo "### ğŸ“‹ ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ"
          echo "- [ ] å¤‰æ›´å†…å®¹ã‚’ç¢ºèªæ¸ˆã¿"
          echo "- [ ] ãƒ†ã‚¹ãƒˆãŒé€šéã™ã‚‹ã“ã¨ã‚’ç¢ºèªæ¸ˆã¿"
          echo "- [ ] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æ›´æ–°æ¸ˆã¿ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰"
          echo "- [ ] ç ´å£Šçš„å¤‰æ›´ãŒãªã„ã“ã¨ã‚’ç¢ºèªæ¸ˆã¿"
          echo ""
          echo "---"
          echo "ğŸ¤– ã“ã®PRã¯è‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã—ãŸã€‚ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’ãŠé¡˜ã„ã—ã¾ã™ï¼"
        } > pr_body.md
        
        echo "body_file=pr_body.md" >> $GITHUB_OUTPUT
    
    - name: Create Pull Request
      if: steps.check_pr.outputs.exists == 'false'
      id: create_pr
      env:
        GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      run: |
        BRANCH_NAME="${{ steps.branch_info.outputs.branch_name }}"
        BASE_BRANCH="${{ steps.branch_info.outputs.base_branch }}"
        PR_TITLE="${{ steps.branch_info.outputs.pr_title }}"
        
        # PRæœ¬æ–‡ãƒ•ã‚¡ã‚¤ãƒ«ã®å­˜åœ¨ç¢ºèª
        if [ ! -f pr_body.md ]; then
          echo "âš ï¸ pr_body.md ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆæœ¬æ–‡ã‚’ä½œæˆã—ã¾ã™ã€‚"
          echo "## ğŸ¤– è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸPull Request" > pr_body.md
          echo "" >> pr_body.md
          echo "ãƒ–ãƒ©ãƒ³ãƒ \`$BRANCH_NAME\` ã‹ã‚‰ \`$BASE_BRANCH\` ã¸ã®å¤‰æ›´ã‚’ãƒ¬ãƒ“ãƒ¥ãƒ¼ã—ã¦ãã ã•ã„ã€‚" >> pr_body.md
        fi
        
        # GitHub CLI ã§PRã‚’ä½œæˆ
        PR_URL=$(gh pr create \
          --title "$PR_TITLE" \
          --body-file pr_body.md \
          --base "$BASE_BRANCH" \
          --head "$BRANCH_NAME" \
          --label "auto-generated,needs-review" \
          --repo ${{ github.repository }})
        
        # PRç•ªå·ã‚’æŠ½å‡º
        PR_NUMBER=$(echo "$PR_URL" | grep -o '[0-9]\+$')
        
        echo "âœ… PR #$PR_NUMBER ãŒä½œæˆã•ã‚Œã¾ã—ãŸ: $PR_URL"
        echo "pull-request-number=$PR_NUMBER" >> $GITHUB_OUTPUT
        echo "pull-request-url=$PR_URL" >> $GITHUB_OUTPUT
    
    - name: Add labels to PR
      if: steps.create_pr.outputs.pull-request-number != '' || steps.check_pr.outputs.exists == 'true'
      env:
        GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      run: |
        # æ–°è¦ä½œæˆã•ã‚ŒãŸPRã¾ãŸã¯æ—¢å­˜ã®PRã®ç•ªå·ã‚’å–å¾—
        if [ "${{ steps.check_pr.outputs.exists }}" == "true" ]; then
          PR_NUMBER="${{ steps.check_pr.outputs.pr_number }}"
          echo "æ—¢å­˜ã®PR #$PR_NUMBER ã«ãƒ©ãƒ™ãƒ«ã‚’è¿½åŠ ã—ã¾ã™"
        else
          PR_NUMBER="${{ steps.create_pr.outputs.pull-request-number }}"
          echo "æ–°è¦PR #$PR_NUMBER ã«ãƒ©ãƒ™ãƒ«ã‚’è¿½åŠ ã—ã¾ã™"
        fi
        
        BRANCH_NAME="${{ steps.branch_info.outputs.branch_name }}"
        
        # è¿½åŠ ã®ãƒ–ãƒ©ãƒ³ãƒå›ºæœ‰ãƒ©ãƒ™ãƒ«
        ADDITIONAL_LABELS=""
        
        if [[ "$BRANCH_NAME" == feature/* ]]; then
          ADDITIONAL_LABELS="enhancement"
        elif [[ "$BRANCH_NAME" == fix/* ]] || [[ "$BRANCH_NAME" == bugfix/* ]]; then
          ADDITIONAL_LABELS="bug"
        elif [[ "$BRANCH_NAME" == hotfix/* ]]; then
          ADDITIONAL_LABELS="hotfix,priority-high"
        elif [[ "$BRANCH_NAME" == docs/* ]]; then
          ADDITIONAL_LABELS="documentation"
        fi
        
        if [ -n "$ADDITIONAL_LABELS" ]; then
          gh pr edit "$PR_NUMBER" --add-label "$ADDITIONAL_LABELS" || echo "è¿½åŠ ãƒ©ãƒ™ãƒ«è¨­å®šã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã—ãŸ"
        fi
    
    - name: Request Copilot Code Review
      if: steps.create_pr.outputs.pull-request-number != '' || steps.check_pr.outputs.exists == 'true'
      env:
        GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      run: |
        # PRç•ªå·ã‚’å–å¾—
        if [ "${{ steps.check_pr.outputs.exists }}" == "true" ]; then
          PR_NUMBER="${{ steps.check_pr.outputs.pr_number }}"
          echo "æ—¢å­˜ã®PR #$PR_NUMBER ã«Copilotãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’è¿½åŠ ã—ã¾ã™"
        else
          PR_NUMBER="${{ steps.create_pr.outputs.pull-request-number }}"
          echo "æ–°è¦PR #$PR_NUMBER ã«Copilotãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’è¿½åŠ ã—ã¾ã™"
        fi
        
        # GitHub Copilot ã«ã‚ˆã‚‹è‡ªå‹•ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚³ãƒ¡ãƒ³ãƒˆ
        cat > copilot_review.md << 'EOF'
        ## ğŸ¤– GitHub Copilot è‡ªå‹•ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼
        
        ### ğŸ“Š åˆ†æçµæœ
        ã“ã®ã‚³ãƒ¼ãƒ‰ã«ã¤ã„ã¦ä»¥ä¸‹ã®è¦³ç‚¹ã‹ã‚‰åˆ†æã—ã¾ã—ãŸï¼š
        
        **ğŸ” ã‚³ãƒ¼ãƒ‰å“è³ªãƒã‚§ãƒƒã‚¯:**
        - å‘½åè¦å‰‡ã®ä¸€è²«æ€§
        - é–¢æ•°ã®è¤‡é›‘åº¦
        - ã‚³ãƒ¡ãƒ³ãƒˆã®é©åˆ‡æ€§
        - ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
        
        **ğŸš€ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åˆ†æ:**
        - å‡¦ç†åŠ¹ç‡
        - ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡
        - ãƒ«ãƒ¼ãƒ—æœ€é©åŒ–
        
        **ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯:**
        - å…¥åŠ›å€¤æ¤œè¨¼
        - XSS/CSRFå¯¾ç­–
        - æ©Ÿå¯†æƒ…å ±ã®éœ²å‡º
        
        **ğŸ“ æ”¹å–„ææ¡ˆ:**
        è©³ç´°ãªãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚³ãƒ¡ãƒ³ãƒˆã‚’å„ãƒ•ã‚¡ã‚¤ãƒ«ã«è¿½åŠ ã—ã¾ã™ã€‚
        
        ---
        â„¹ï¸ ã‚ˆã‚Šè©³ç´°ãªåˆ†æãŒå¿…è¦ãªå ´åˆã¯ã€PRå†…ã§ `@github copilot` ã«ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ã—ã¦ãã ã•ã„ã€‚
        EOF
        
        gh pr comment "$PR_NUMBER" --body-file copilot_review.md
        echo "Copilot ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚³ãƒ¡ãƒ³ãƒˆã‚’è¿½åŠ ã—ã¾ã—ãŸ"
    
    - name: Set up Node.js for additional checks
      uses: actions/setup-node@v4
      with:
        node-version: '18'
    
    - name: Run enhanced code analysis
      id: code_analysis
      continue-on-error: true
      run: |
        PR_NUMBER="${{ steps.create_pr.outputs.pull-request-number }}"
        
        if [ -z "$PR_NUMBER" ]; then
          echo "PRç•ªå·ãŒå–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚ã‚¹ã‚­ãƒƒãƒ—ã—ã¾ã™ã€‚"
          exit 0
        fi
        
        # å¤‰æ›´ã•ã‚ŒãŸJSãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒã‚§ãƒƒã‚¯
        CHANGED_JS_FILES=$(git diff --name-only origin/${{ steps.branch_info.outputs.base_branch }}..HEAD | grep '\.js$' || true)
        
        if [ -n "$CHANGED_JS_FILES" ]; then
          echo "## ğŸ” JavaScript ãƒ•ã‚¡ã‚¤ãƒ«åˆ†æçµæœ" > analysis_report.md
          echo "" >> analysis_report.md
          
          for file in $CHANGED_JS_FILES; do
            if [ -f "$file" ]; then
              echo "### ğŸ“„ \`$file\`" >> analysis_report.md
              
              # ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚ºãƒã‚§ãƒƒã‚¯
              FILE_SIZE=$(wc -c < "$file")
              echo "- **ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º**: ${FILE_SIZE} bytes" >> analysis_report.md
              
              # è¤‡é›‘åº¦ã®ç°¡æ˜“ãƒã‚§ãƒƒã‚¯
              FUNCTION_COUNT=$(grep -c "function\|=>" "$file" || echo "0")
              echo "- **é–¢æ•°æ•°**: $FUNCTION_COUNT" >> analysis_report.md
              
              # TODOã‚³ãƒ¡ãƒ³ãƒˆã®æ¤œç´¢
              TODO_COUNT=$(grep -c "TODO\|FIXME\|XXX" "$file" || echo "0")
              if [ "$TODO_COUNT" -gt 0 ]; then
                echo "- **âš ï¸ TODO/FIXME**: $TODO_COUNT ç®‡æ‰€" >> analysis_report.md
              fi
              
              echo "" >> analysis_report.md
            fi
          done
          
          # åˆ†æçµæœã‚’PRã«ã‚³ãƒ¡ãƒ³ãƒˆ
          gh pr comment "$PR_NUMBER" --body-file analysis_report.md
        fi
    
    - name: Update PR status
      if: steps.create_pr.outputs.pull-request-number != ''
      env:
        GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      run: |
        PR_NUMBER="${{ steps.create_pr.outputs.pull-request-number }}"
        
        echo "âœ… PR #$PR_NUMBER ã®è‡ªå‹•ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãŒå®Œäº†ã—ã¾ã—ãŸ"
    
    - name: Notify in PR
      if: steps.create_pr.outputs.pull-request-number != ''
      env:
        GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      run: |
        PR_NUMBER="${{ steps.create_pr.outputs.pull-request-number }}"
        
        cat > final_notification.md << 'EOF'
        ## ğŸ‰ è‡ªå‹•PRä½œæˆå®Œäº†ï¼
        
        ã“ã®PRã¯è‡ªå‹•çš„ã«ä½œæˆãƒ»è¨­å®šã•ã‚Œã¾ã—ãŸã€‚ä»¥ä¸‹ã®ä½œæ¥­ãŒå®Œäº†ã—ã¦ã„ã¾ã™ï¼š
        
        âœ… **åŸºæœ¬è¨­å®š**
        - Pull Requestä½œæˆ
        - é©åˆ‡ãªãƒ©ãƒ™ãƒ«ä»˜ä¸
        - ãƒ™ãƒ¼ã‚¹ãƒ–ãƒ©ãƒ³ãƒè¨­å®š
        
        âœ… **ã‚³ãƒ¼ãƒ‰åˆ†æ**
        - GitHub Copilot ãƒ¬ãƒ“ãƒ¥ãƒ¼å®Ÿè¡Œ
        - JavaScript ãƒ•ã‚¡ã‚¤ãƒ«åˆ†æ
        - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯
        
        âœ… **CI/CDçµ±åˆ**
        - è‡ªå‹•ãƒ†ã‚¹ãƒˆå®Ÿè¡Œäºˆç´„
        - ãƒ“ãƒ«ãƒ‰æ¤œè¨¼è¨­å®š
        
        ### ğŸ”„ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—
        1. ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®ç¢ºèª
        2. ãƒ†ã‚¹ãƒˆçµæœã®ç¢ºèª
        3. å¿…è¦ã«å¿œã˜ã¦ä¿®æ­£
        4. ãƒãƒ¼ã‚¸æº–å‚™
        
        ---
        ğŸ“ **ãƒ¬ãƒ“ãƒ¥ã‚¢ãƒ¼ã®æ–¹ã¸**: ã“ã®PRã¯è‡ªå‹•ç”Ÿæˆã•ã‚Œã¦ã„ã¾ã™ãŒã€äººã®ç›®ã«ã‚ˆã‚‹ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚‚é‡è¦ã§ã™ã€‚ç‰¹ã«ä»¥ä¸‹ã®ç‚¹ã‚’ã”ç¢ºèªãã ã•ã„ï¼š
        - ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã®å¦¥å½“æ€§
        - ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£
        - æ„å›³ã—ãŸå‹•ä½œã¨ã®æ•´åˆæ€§
        EOF
        
        gh pr comment "$PR_NUMBER" --body-file final_notification.md
    
    - name: Request GitHub Copilot Review
      if: steps.create_pr.outputs.pull-request-number != ''
      env:
        GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
      run: |
        PR_NUMBER="${{ steps.create_pr.outputs.pull-request-number }}"
        
        cat > copilot_request.md << 'EOF'
        ## ğŸ¤– GitHub Copilot AI ãƒ¬ãƒ“ãƒ¥ãƒ¼è¦æ±‚
        
        @copilot ã“ã®PRã®åŒ…æ‹¬çš„ãªã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’ãŠé¡˜ã„ã—ã¾ã™ã€‚
        
        ### ğŸ“‹ ãƒ¬ãƒ“ãƒ¥ãƒ¼é …ç›®
        
        **ğŸ” ã‚³ãƒ¼ãƒ‰å“è³ªåˆ†æ:**
        - å‘½åè¦å‰‡ã¨ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¹ã‚¿ã‚¤ãƒ«
        - é–¢æ•°ãƒ»ã‚¯ãƒ©ã‚¹ã®è¨­è¨ˆ
        - ã‚³ãƒ¡ãƒ³ãƒˆã¨å¯èª­æ€§
        
        **ğŸš€ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è©•ä¾¡:**
        - ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®åŠ¹ç‡æ€§
        - ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡
        - Canvas API ã®æœ€é©åŒ–
        
        **ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯:**
        - å…¥åŠ›å€¤æ¤œè¨¼
        - XSS/CSRFå¯¾ç­–
        - ãƒ‡ãƒ¼ã‚¿éœ²å‡ºãƒªã‚¹ã‚¯
        
        **ğŸ§ª ãƒ†ã‚¹ã‚¿ãƒ“ãƒªãƒ†ã‚£:**
        - ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆå¯èƒ½æ€§
        - ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ€§
        - ä¾å­˜é–¢ä¿‚ã®ç®¡ç†
        
        **ğŸ“± ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£:**
        - ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰æ“ä½œå¯¾å¿œ
        - ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ãƒªãƒ¼ãƒ€ãƒ¼å¯¾å¿œ
        - ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³
        
        ### ğŸ¯ ç‰¹ã«æ³¨ç›®ã—ã¦ã»ã—ã„ç‚¹
        
        1. **Flappy Bird ã‚²ãƒ¼ãƒ ãƒ­ã‚¸ãƒƒã‚¯** - ã‚²ãƒ¼ãƒ ã®çŠ¶æ…‹ç®¡ç†ã¨ã‚¤ãƒ™ãƒ³ãƒˆãƒ«ãƒ¼ãƒ—
        2. **Canvas æç”»å‡¦ç†** - æç”»ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã¨æœ€é©åŒ–
        3. **UI/UX** - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ã‚¯ã‚¹ãƒšãƒªã‚¨ãƒ³ã‚¹ã®å‘ä¸Šææ¡ˆ
        4. **ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ§‹é€ ** - ã‚³ãƒ¼ãƒ‰ã®ä¿å®ˆæ€§ã¨æ‹¡å¼µæ€§
        
        @copilot è©³ç´°ãªåˆ†æã¨æ”¹å–„ææ¡ˆã‚’ã‚ˆã‚ã—ããŠé¡˜ã„ã—ã¾ã™ï¼
        
        ---
        *ã“ã®è¦æ±‚ã¯è‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã—ãŸã€‚è¿½åŠ ã®è³ªå•ãŒã‚ã‚‹å ´åˆã¯ã€ã“ã®PRã§ã•ã‚‰ã« @copilot ã«ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ã—ã¦ãã ã•ã„ã€‚*
        EOF
        
        # GitHub Copilot ãƒ¬ãƒ“ãƒ¥ãƒ¼è¦æ±‚ã‚’æŠ•ç¨¿
        if gh pr comment "$PR_NUMBER" --body-file copilot_request.md; then
          echo "âœ… GitHub Copilot ãƒ¬ãƒ“ãƒ¥ãƒ¼è¦æ±‚ãŒæŠ•ç¨¿ã•ã‚Œã¾ã—ãŸ"
        else
          echo "âš ï¸ Copilot ãƒ¬ãƒ“ãƒ¥ãƒ¼è¦æ±‚ã®æŠ•ç¨¿ã«å¤±æ•—ã—ã¾ã—ãŸ"
        fi
